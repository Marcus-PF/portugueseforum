---
applyTo: '**'
---

// This file is automatically generated by Nx Console

You are in an Nx workspace using Nx 21.2.2 and pnpm as the package manager.

This is a full-stack TypeScript monorepo for the **Portuguese Forum of South Africa**, built around a modular architecture with shared libraries and clear domain boundaries.

# ğŸ§­ Workspace Context

You are working in a hybrid monorepo that includes:

- `apps/forum` â€“ A multilingual frontend built with **Next.js 15** (App Router) and `next-intl@4.3.4`, served at `/[locale]/â€¦`.
- `apps/api` â€“ A **Hono-based backend** with MongoDB, JWT, and Zod-based route validation.
- `libs/data` â€“ Shared **Mongoose v8 schemas**, CRUD services, and utilities for DB, email, API clients, etc.
- `libs/ui` â€“ Tailwind v4 + **ShadCN component system** with React 19.
- Planning underway to extract i18n, config, and auth into new shared libraries.

Your workspace uses strict ESLint boundaries, Vitest testing, and tags like `scope:shared`, `type:library`, `scope:api`, etc.

# âš™ General Guidelines

- When answering questions, use the `nx_workspace` tool to understand project structure and library/app relationships.
- For Nx-specific configuration questions or edge cases, always check the **latest official docs** using `nx_docs` instead of assuming behavior.
- For errors, dependency issues, or project graph insights, use:
  - `nx_workspace` (for structure and metadata)
  - `nx_project_details` (for individual project info)
  - `nx_visualize_graph` (to understand dependency relationships visually)

# ğŸ— Generation Guidelines

If the user asks to **generate a new app, library, or file**, follow this flow:

1. Use `nx_workspace` and `nx_project_details` to learn about their current structure and naming conventions.
2. Use `nx_generators` to list available generators.
3. If unsure which generator fits, check `nx_available_plugins` for plugins like `@nx/next`, `@nx/node`, `@nx/react`, `@nx/js`, etc.
4. Use `nx_generator_schema` to confirm required and optional flags.
5. Use `nx_open_generate_ui` to initiate the generator via UI.
6. After generation, confirm what was created using `nx_read_generator_log`.

> **Naming conventions:**
> - Libraries use `kebab-case`
> - Apps are under `apps/`
> - All exports are **named**, not default
> - File-level module boundaries are enforced

# ğŸ§ª Testing Guidelines

- Vitest is used across all libraries
- Run tests with `nx test <project>`
- Dev dependencies are centralized and all tests must pass in CI
- Environment-specific `.env.test` exists for `libs/data`

# ğŸ§ª CI & Error Resolution Guidelines

For CI pipeline or task errors:

1. Use `nx_cloud_cipe_details` to get pipeline metadata.
2. Use `nx_cloud_fix_cipe_failure` to drill into failed CI tasks.
3. Review the task logs and identify the failure root cause (commonly lint, build, or test).
4. Rerun the task locally using `nx run <project>:<target>` or `nx affected:test` after fixing.
5. Confirm the fix by rechecking with `nx test`, `nx lint`, or CI logs.

# ğŸ” Access & Scope Rules

- Enforced via `@nx/enforce-module-boundaries`
- Apps can only import from `scope:shared`, `scope:ui`, `scope:data`
- Auth logic, i18n, and environment helpers are planned to move to their own libraries for reuse

# ğŸ§­ Roadmap Context (as of July 2025)

These are current initiatives underway:

- Migrate `i18n` from `apps/forum` to `libs/i18n`
- Harden `apps/api` with JWT + role-based access
- Configure MongoDB Compass (dev) and MongoDB Atlas (prod)
- Add `voz` model and GridFS PDF support
- Implement `@pfsa/auth`, `@pfsa/config`, `@pfsa/email` as future shared libraries

---
